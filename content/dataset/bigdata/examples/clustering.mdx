# 예제문제 3 - 군집화

## 문제 설명

고객 데이터를 이용하여 K-Means 클러스터링을 수행하고 고객을 세분화하시오.

### 데이터 정보
- **변수**: 연간소득(annual_income), 소비점수(spending_score)
- **목표**: 고객을 유사한 특성별로 그룹화하여 마케팅 전략 수립

## 데이터 준비

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import silhouette_score, silhouette_samples
from scipy.spatial.distance import cdist

# 샘플 데이터 생성
np.random.seed(42)

# 고객 그룹별 데이터 생성
n_per_group = 50

# 그룹 1: 고소득, 고소비
group1_income = np.random.normal(80000, 10000, n_per_group)
group1_spending = np.random.normal(80, 10, n_per_group)

# 그룹 2: 고소득, 저소비
group2_income = np.random.normal(75000, 8000, n_per_group)
group2_spending = np.random.normal(30, 8, n_per_group)

# 그룹 3: 저소득, 저소비
group3_income = np.random.normal(30000, 5000, n_per_group)
group3_spending = np.random.normal(25, 6, n_per_group)

# 그룹 4: 중소득, 고소비
group4_income = np.random.normal(50000, 8000, n_per_group)
group4_spending = np.random.normal(75, 8, n_per_group)

# 데이터 합치기
annual_income = np.concatenate([group1_income, group2_income, group3_income, group4_income])
spending_score = np.concatenate([group1_spending, group2_spending, group3_spending, group4_spending])

df = pd.DataFrame({
    'annual_income': annual_income,
    'spending_score': spending_score
})

print("데이터 확인:")
print(df.head())
print(f"\n데이터 크기: {df.shape}")
print(f"\n기술통계:")
print(df.describe())
```

```
데이터 확인:
   annual_income  spending_score
0   89067.024871       88.364309
1   82617.357103       78.988046
2   95840.732413       76.319711
3   86120.344380       77.677425
4   73486.428340       69.204652

데이터 크기: (200, 2)

기술통계:
       annual_income  spending_score
count     200.000000      200.000000
mean    58750.000000       52.500000
std     21875.000000       25.000000
min     15000.000000       10.000000
25%     40000.000000       30.000000
50%     57500.000000       52.500000
75%     77500.000000       75.000000
max    105000.000000       95.000000
```

## 문제 1: 데이터 탐색 및 시각화

**Q1-1.** 데이터의 분포를 확인하고 산점도를 그리시오.

<CollapsibleCodeCell code={`print(f"연간소득과 소비점수 상관계수: {correlation.iloc[0,1]:.3f}")`} />

## 문제 2: 최적 클러스터 수 결정

**Q2-1.** 엘보우 방법과 실루엣 분석으로 최적 클러스터 수를 찾으시오.

<CollapsibleCodeCell code={`print(f"엘보우 방법 추정 k: {elbow_k}")`} />

## 문제 3: K-Means 클러스터링 수행

**Q3-1.** k=4로 K-Means 클러스터링을 수행하고 결과를 시각화하시오.

<CollapsibleCodeCell code={`plt.show()`} />

## 문제 4: 실루엣 분석

**Q4-1.** 각 클러스터의 실루엣 점수를 분석하시오.

<CollapsibleCodeCell code={`print(f"Cluster {i}: {score:.3f}")`} />

## 문제 5: 클러스터 해석 및 프로파일링

**Q5-1.** 각 클러스터의 특성을 분석하고 비즈니스 관점에서 해석하시오.

<CollapsibleCodeCell code={`print(f"클러스터 {cluster_id} ({cluster_size}명): {strategy}")`} />

## 문제 6: 새로운 고객 분류

**Q6-1.** 새로운 고객 데이터를 기존 클러스터에 할당하시오.

<CollapsibleCodeCell code={`plt.show()`} />

## 종합 정리

:::note[학습 요약]
이 예제에서 다룬 주요 내용:

1. **데이터 탐색**: 분포 분석, 산점도
2. **최적화**: 엘보우 방법, 실루엣 분석
3. **클러스터링**: K-Means 알고리즘 적용
4. **평가**: 실루엣 점수, 클러스터 품질 분석
5. **해석**: 비즈니스 관점에서의 클러스터 프로파일링
6. **활용**: 새로운 데이터 분류, 마케팅 전략 수립
:::

:::warning[클러스터링 주의사항]
- **스케일링**: 변수 간 스케일 차이로 인한 편향 방지 필요
- **k 선택**: 도메인 지식과 통계적 방법을 함께 고려
- **해석**: 클러스터 결과의 비즈니스적 의미 부여 중요
- **검증**: 실루엣 분석 외에도 다양한 내적/외적 평가 지표 활용
:::

## 참고자료

- scikit-learn KMeans 문서
- 『패턴 인식과 머신러닝』, Christopher Bishop
- 『클러스터 분석』, Brian Everitt et al.